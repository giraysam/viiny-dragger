/*! viiny-dragger 2015-12-29 */
!function(a){"use strict";window.ViinyDragger=a()}(function(){function a(a){this.options=a,this.points={elmX:0,elmY:0,firstMouseX:0,firstMouseY:0,lastMouseX:0,lastMouseY:0}}function b(a){this.Positions=a}function c(a){b.call(this,a)}function d(a){b.call(this,a)}function e(){}function f(){for(var a=1;a<arguments.length;a++)for(var b in arguments[a])arguments[a].hasOwnProperty(b)&&(arguments[0][b]=arguments[a][b]);return arguments[0]}function g(a,b){var c={activeClass:"",snapX:1,snapY:1,axisX:!0,axisY:!0,onStart:function(a,b){},onDrag:function(a,b){},onStop:function(a,b){}};return this.options=f(c,b),new g.instance(a,this.options)}var h=!1;return a.prototype={getOptions:function(){return this.options},setPoints:function(a){a.elmX&&(this.points.elmX=a.elmX),a.elmY&&(this.points.elmY=a.elmY),a.firstMouseX&&(this.points.firstMouseX=a.firstMouseX),a.firstMouseY&&(this.points.firstMouseY=a.firstMouseY),a.lastMouseX&&(this.points.lastMouseX=a.lastMouseX),a.lastMouseY&&(this.points.lastMouseY=a.lastMouseY)},getPoints:function(){return this.points},getDistanceX:function(){return Math.abs(this.points.lastMouseX-this.points.firstMouseX)},getDistanceY:function(){return Math.abs(this.points.lastMouseY-this.points.firstMouseY)},getX:function(){return this.points.lastMouseX-this.points.elmX},getY:function(){return this.points.lastMouseY-this.points.elmY}},b.prototype={getOptions:function(){return this.Positions.getOptions()},setPoints:function(a){this.Positions.setPoints(a)},getPoints:function(){return this.Positions.getPoints()},getDistanceX:function(){return this.Positions.getDistanceX()},getDistanceY:function(){return this.Positions.getDistanceY()},getX:function(){return this.Positions.getX()},getY:function(){return this.Positions.getY()}},c.prototype=new b,c.prototype.getX=function(){var a=this.Positions.getOptions().snapX;return Math.round(this.Positions.getX()/a)*a},c.prototype.getY=function(){var a=this.Positions.getOptions().snapY;return Math.round(this.Positions.getY()/a)*a},d.prototype=new b,d.prototype.getX=function(){var a=this.Positions.getOptions().axisX;return 1==a?this.Positions.getX():null},d.prototype.getY=function(){var a=this.Positions.getOptions().axisY;return 1==a?this.Positions.getY():null},e.prototype={addClass:function(a,b){return this.hasClass(a,b)?!0:void(a.className+=" "+b)},hasClass:function(a,b){var c=new RegExp("(^| )"+b+"( |$)");return a.className&&a.className.match(c)},removeClass:function(a,b){var c,d;c=a.className,d=new RegExp("(^| )"+b+"( |$)"),c=c.replace(d,"").replace(/ /g," "),a.className=c}},g.instance=function(b,f){var g=this;this.el=b,this.options=f,this.Positions=new a(this.options),this.ClassManager=new e,(0==this.options.axisX||0==this.options.axisY)&&(this.Positions=new d(this.Positions)),(1!=this.options.snapX||1!=this.options.snapY)&&(this.Positions=new c(this.Positions)),this.el.onmousedown=function(a){g.mousedownHandler(a)}},g.instance.prototype={mousedownHandler:function(a){var b=document.all?window.event:a,c=this,d=document.all?window.event.clientX:a.pageX,e=document.all?window.event.clientY:a.pageY;b.preventDefault?b.preventDefault():document.onselectstart=function(){return!1},this.ClassManager.addClass(this.el,this.options.activeClass),"function"==typeof this.options.onStart&&this.options.onStart(b,this.el),h=!0,this.el.style.zIndex=99999,this.Positions.setPoints({firstMouseX:d,firstMouseY:e,elmX:d-this.el.offsetLeft,elmY:e-this.el.offsetTop}),document.onmousemove=function(a){var b=document.all?window.event:a;c.mousemoveHandler(b)},document.onmouseup=function(a){var b=document.all?window.event:a;c.mouseupHandler(b)}},mousemoveHandler:function(a){var b=document.all?window.event.clientX:a.pageX,c=document.all?window.event.clientY:a.pageY;this.Positions.setPoints({lastMouseX:b,lastMouseY:c}),h!==!1&&(null!==this.Positions.getX()&&(this.el.style.left=this.Positions.getX()+"px"),null!==this.Positions.getY()&&(this.el.style.top=this.Positions.getY()+"px"),"function"==typeof this.options.onDrag&&this.options.onDrag(a,this.el))},mouseupHandler:function(a){h!==!1&&(this.ClassManager.removeClass(this.el,this.options.activeClass),a.distanceX=this.Positions.getDistanceX(),a.distanceY=this.Positions.getDistanceY(),"function"==typeof this.options.onStop&&this.options.onStop(a,this.el),this.el.style.zIndex="",h=!1)}},g});